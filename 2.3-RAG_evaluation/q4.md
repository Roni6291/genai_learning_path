# RAG Evaluation - NDCG (Normalized Discounted Cumulative Gain)

## ðŸ“š Given Relevance Scores

| Rank | Retrieved Document | Relevance Score |
|------|-------------------|-----------------|
| 1 | The Pacific Ocean is the largest ocean. | 3 |
| 2 | The Atlantic Ocean separates Europe and America. | 2 |
| 3 | The Sahara Desert is the largest hot desert. | 0 |
| 4 | The Indian Ocean is the third largest ocean. | 1 |

## ðŸŽ¯ Objective

Compute the following metrics:
1. **DCG@4** (Discounted Cumulative Gain)
2. **IDCG@4** (Ideal DCG)
3. **NDCG@4** (Normalized DCG)

---

## ðŸ“Š Step 1: Compute DCG@4

**Formula:**
$$\text{DCG@K} = \sum_{i=1}^{K} \frac{\text{rel}_i}{\log_2(i+1)}$$

**Calculation (term by term):**

| Position (i) | Relevance | logâ‚‚(i+1) | rel / logâ‚‚(i+1) |
|--------------|-----------|-----------|-----------------|
| 1 | 3 | logâ‚‚(2) = 1.000 | 3.000 |
| 2 | 2 | logâ‚‚(3) â‰ˆ 1.585 | 1.262 |
| 3 | 0 | logâ‚‚(4) = 2.000 | 0.000 |
| 4 | 1 | logâ‚‚(5) â‰ˆ 2.321 | 0.431 |

**Result:**
$$\text{DCG@4} = 3.000 + 1.262 + 0.000 + 0.431 = 4.693$$

---

## ðŸ“ˆ Step 2: Compute IDCG@4 (Ideal DCG)

First, sort the relevance scores in **descending order** (best possible ranking):

**Ideal Order:** [3, 2, 1, 0]

**Calculation:**

| Position (i) | Relevance | logâ‚‚(i+1) | rel / logâ‚‚(i+1) |
|--------------|-----------|-----------|-----------------|
| 1 | 3 | logâ‚‚(2) = 1.000 | 3.000 |
| 2 | 2 | logâ‚‚(3) â‰ˆ 1.585 | 1.262 |
| 3 | 1 | logâ‚‚(4) = 2.000 | 0.500 |
| 4 | 0 | logâ‚‚(5) â‰ˆ 2.321 | 0.000 |

**Result:**
$$\text{IDCG@4} = 3.000 + 1.262 + 0.500 + 0.000 = 4.762$$

---

## ðŸŽ¯ Step 3: Compute NDCG@4

**Formula:**
$$\text{NDCG@4} = \frac{\text{DCG@4}}{\text{IDCG@4}} = \frac{4.693}{4.762} \approx 0.9855$$

---

## âœ… Final Results

| Metric | Value |
|--------|-------|
| **DCG@4** | 4.693 |
| **IDCG@4** | 4.762 |
| **NDCG@4** | **0.9855** |

### Interpretation
An NDCG@4 score of **0.9855** (98.55%) indicates excellent ranking quality. The retrieved documents are nearly optimally ordered, with only a minor deviation from the ideal ranking.
